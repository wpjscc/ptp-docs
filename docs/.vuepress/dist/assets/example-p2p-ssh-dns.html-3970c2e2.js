import{_ as a,o as n,c as s,e}from"./app-91fc3477.js";const t={},p=e(`<h1 id="示例-点对点内网穿透-ssh-dns" tabindex="-1"><a class="header-anchor" href="#示例-点对点内网穿透-ssh-dns" aria-hidden="true">#</a> 示例-点对点内网穿透-ssh-dns</h1><h2 id="要求" tabindex="-1"><a class="header-anchor" href="#要求" aria-hidden="true">#</a> 要求</h2><ul><li>服务端IP</li><li>服务端暴露32123端口</li></ul><h2 id="_1-配置" tabindex="-1"><a class="header-anchor" href="#_1-配置" aria-hidden="true">#</a> 1 配置</h2><p>服务端配置 <code>ptps-p2p.ini</code></p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">common</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">tunnel_80_port</span> <span class="token punctuation">=</span> <span class="token value attr-value">32123</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>客户端1配置 <code>ptpc-p2p-dns.ini</code> 提供dns服务，供客户端2查询</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">common</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">tunnel_host</span> <span class="token punctuation">=</span> <span class="token value attr-value">192.168.1.9</span>
<span class="token key attr-name">tunnel_80_port</span> <span class="token punctuation">=</span> <span class="token value attr-value">32123</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">tcp</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">ip</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span>
<span class="token key attr-name">ports</span><span class="token punctuation">=</span><span class="token value attr-value">3001</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">udp</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">ip</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span>
<span class="token key attr-name">ports</span><span class="token punctuation">=</span><span class="token value attr-value">3001</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">p2p-ssh1</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">tunnel_protocol</span> <span class="token punctuation">=</span> <span class="token value attr-value">p2p</span>
<span class="token key attr-name">local_protocol</span> <span class="token punctuation">=</span> <span class="token value attr-value">udp</span>
<span class="token key attr-name">local_host</span> <span class="token punctuation">=</span> <span class="token value attr-value">8.8.8.8</span>
<span class="token key attr-name">local_port</span> <span class="token punctuation">=</span> <span class="token value attr-value">53</span>
<span class="token key attr-name">domain</span> <span class="token punctuation">=</span> <span class="token value attr-value">127.0.0.1:4000</span>
<span class="token key attr-name">token</span> <span class="token punctuation">=</span> <span class="token value attr-value">123456</span>
<span class="token key attr-name">is_need_local</span> <span class="token punctuation">=</span> <span class="token value attr-value">true</span>
<span class="token key attr-name">try_tcp</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>客户端2配置 <code>ptpc-p2p-ssh.ini</code> 提供ssh服务供客户端1连接</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">common</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">tunnel_host</span> <span class="token punctuation">=</span> <span class="token value attr-value">x.x.x.x</span>
<span class="token key attr-name">tunnel_80_port</span> <span class="token punctuation">=</span> <span class="token value attr-value">32123</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">tcp</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">ip</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span>
<span class="token key attr-name">ports</span><span class="token punctuation">=</span><span class="token value attr-value">4000</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">udp</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">ip</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span>
<span class="token key attr-name">ports</span><span class="token punctuation">=</span><span class="token value attr-value">4000</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">p2p-ssh2</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">tunnel_protocol</span> <span class="token punctuation">=</span> <span class="token value attr-value">p2p</span>
<span class="token key attr-name">local_host</span> <span class="token punctuation">=</span> <span class="token value attr-value">127.0.0.1</span>
<span class="token key attr-name">local_port</span> <span class="token punctuation">=</span> <span class="token value attr-value">22</span>
<span class="token key attr-name">token</span> <span class="token punctuation">=</span> <span class="token value attr-value">123456</span>
<span class="token key attr-name">is_need_local</span> <span class="token punctuation">=</span> <span class="token value attr-value">true</span>
<span class="token key attr-name">domain</span> <span class="token punctuation">=</span> <span class="token value attr-value">127.0.0.1:3001</span>
<span class="token key attr-name">try_tcp</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>x.x.x.x</code> 是服务端ip</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><ul><li>token 一样才能连接上</li><li>is_need_local 是否推送内网ip <ul><li>两个客户端在同一局域网下最好开启</li></ul></li><li>try_tcp 在udp 打通后会试着打通tcp，需要两端都开启</li></ul></div><h2 id="_2-启动" tabindex="-1"><a class="header-anchor" href="#_2-启动" aria-hidden="true">#</a> 2 启动</h2><p>服务端</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>./ptp <span class="token parameter variable">-s</span> --ini-path<span class="token operator">=</span>./ptps-p2p.ini <span class="token parameter variable">-vvv</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>客户端1</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>./ptp <span class="token parameter variable">-c</span> --ini-path<span class="token operator">=</span>./ptpc-p2p-dns.ini <span class="token parameter variable">-vvv</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>客户端2</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>./ptp <span class="token parameter variable">-c</span> --ini-path<span class="token operator">=</span>./ptpc-p2p-ssh.ini <span class="token parameter variable">-vvv</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_3-验证" tabindex="-1"><a class="header-anchor" href="#_3-验证" aria-hidden="true">#</a> 3 验证</h2><p>在客户端1上 ssh 登录到客户端2</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token parameter variable">-p</span> <span class="token number">3001</span> root@127.0.0.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在客户端2 上 查寻 DNS(客户端1提供的dns服务)</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">dig</span> @127.0.0.1 <span class="token parameter variable">-p</span> <span class="token number">4000</span> www.baidu.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_4-原理" tabindex="-1"><a class="header-anchor" href="#_4-原理" aria-hidden="true">#</a> 4 原理</h2>`,25),l=[p];function i(c,o){return n(),s("div",null,l)}const r=a(t,[["render",i],["__file","example-p2p-ssh-dns.html.vue"]]);export{r as default};
